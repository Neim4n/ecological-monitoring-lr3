<div class="lr__table">
    <table class="lr__table-container">
        <tr class="lr__table-tr tr-header">
            <th class="nowrap">№ з/п</th>
            <th>Місто</th>
            <th>Назва забруднюючої речовини</th>
            <!-- EMISSION -->
            <th>Концентрація речовини в амтосферному повітрі <br/> (Ca) <br/> мг/куб.м</th>
            <th>Концентрація речовини у приміщенні <br/> (Ch) <br/> мг/куб.м</th>
            <th>Час поза приміщенням <br/> (Tout) <br/> год/доба</th>
            <th>Час у приміщенні <br/> (Tin) <br/> год/доба</th>
            <th>Швидкість дихання поза приміщенням <br/> (Vout) <br/> куб.м/год</th>
            <th>Швидкість дихання у приміщенні <br/> (Vin) <br/> куб.м/год</th>
            <th>Частота впливу <br/> (EF) <br/> днів/рік</th>
            <th>Тривалість впливу <br/> (ED) <br/> років</th>
            <th>Маса тіла <br/> (BW) <br/> кг</th>
            <th>Період осереднення ексопиззиції <br/> (AT) <br/> років</th>
            <th>Середня концентрація <br/> (AC) <br/> мг/куб.м</th>
            <th>Рефернтра концентрація <br/> (RfC) <br/> мг/куб.м</th>
            <th>Фактор нахилу <br/> (SF) <br/> мг/(кг * доба)</th>
            <th>Чисельність популяції <br/> (POP)</th>
            <!-- CALCULATED -->
            <th>Середня добова доза <br/> (LADD)</th>
            <th>Коефіціент ризику розвитку неканцерогенних ефектів <br/> (HQ)</th>
            <th>Сума HQ всіх забруднювачів <br/> (HI)</th>
            <th>Індивідуальний канцерогенний ризик <br/> (CR)</th>
            <th>Індивідуальний популяційний ризик <br/> (PCR)</th>
        </tr>
        <tr *ngIf="loading" class="lr__table-tr loading">
            <th colspan="7">Loading...</th>
        </tr>
        <ng-container *ngFor="let area of areas; let j = index">
            <tr class="lr__table-tr loading" *ngFor="let info of area['emissions_info']; let i = index">
                <!-- Info -->
                <td class="lr__table-td" *ngIf="i== 0" [attr.rowspan]="area['emissions_info'].length">
                    {{area.id + 1}}
                    <div class="lr__table-td-controls">
                        <button (click)="onDelete(area.id)" class="delete">
                            <mat-icon>clear</mat-icon>
                        </button>
                        <button *ngIf="!area.isEditing" (click)="toggleObjectEdit(j)" class="edit">
                            <mat-icon>mode_edit</mat-icon>
                        </button>
                        <button *ngIf="area.isEditing" (click)="saveEditObject(j)" class="save">
                            <mat-icon>done</mat-icon>
                        </button>
                    </div>
                </td>
                <td class="lr__table-td name" *ngIf="i===0" [attr.rowspan]="area['emissions_info'].length">
                    <span *ngIf="!area.isEditing">{{area.name}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j].name">
                    <a href="{{area['additional_information'].url}}">{{area['additional_information'].year}}</a>
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info['pollutant_name']}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['pollutant_name']">
                </td>
                <!-- Emission -->
                <td>
                    <span *ngIf="!area.isEditing">{{info.Ca}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['Ca']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.Ch}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['Ch']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.Tout}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['Tout']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.Tin}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['Tin']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.Vout}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['Vout']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.Vin}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['Vin']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.EF}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['EF']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.ED}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['ED']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.BW}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['BW']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.AT}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['AT']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.AC}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['AC']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.RfC}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['RfC']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{info.SF}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['emissions_info'][i]['SF']">
                </td>
                <td>
                    <span *ngIf="!area.isEditing">{{area.POP}}</span>
                    <input *ngIf="area.isEditing" type="text"
                           [(ngModel)]="areas[j]['POP']">
                </td>
                <!-- Calculated -->
                <td class="nowrap">
                    {{info.LADD || ' '}}
                </td>
                <td class="nowrap">
                    {{info.HQ ? info.HQ.toFixed(3) : ' '}}
                </td>
                <td *ngIf="i===0" [attr.rowspan]="area['emissions_info'].length" class="nowrap">
                    {{area.HI ? area.HI.toFixed(3) : ' '}}
                </td>
                <td class="nowrap">
                    {{info.CR || ' '}}
                </td>
                <td class="nowrap">
                    {{info.PCR ? info.PCR.toFixed(3) : ' '}}
                </td>
            </tr>
        </ng-container>
    </table>
    <div class="lr__table-control">
        <button class="lr__table-button" [disabled]="isChecked" (click)="calculateRisks()">
            Обрахувати ризики
        </button>
    </div>
</div>
